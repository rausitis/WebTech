{% load static %}
<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="description" content="Comunity for movie lovers">
<meta name="keywords" content="Film, Movie, TV, TV-Show, Actor, Director, Comunity, Discussion, New in Theaters">
<meta name="author" content="Group 15">

<link rel="stylesheet" href="{% static 'CSSstyles/styles.css' %}">
<link rel="stylesheet" href="{% static 'CSSstyles/styles_menu_bar.css' %}">
<link rel="stylesheet" href="{% static 'CSSstyles/styles_registration_page.css' %}">


</head>
<body>

<!--********* TOP BAR *********-->
<div class="topbar">
  <a class="active"  href="LandingPage.html"><img style="width:50px" src="{% static 'images/Logo.png' %}"></a>	
  <a onclick="openNav()">Menu</a>
  <a class="right-align" style = "font-weight: bold;" href="SignIn.html">Sign In</a>
  <a class="right-align" href="Register.html">Register</a>
  <input type="text" placeholder="Search..">
</div>


<!--********* Side Menu *********-->

<div id="SideMenu" class="sidemenu">
  <a href="javascript:void(0)" class="closebtn" onclick="closeNav()">&times;</a>
  <a href="Movies.html">Movies</a>
  <a href="TVShows.html">TV Shows</a>
  <a href="CastAndCrew.html">Cast & Crew</a>
  <a href="Community.html">Community</a>
  <a href="About.html">About</a>
</div>

<script>
function openNav() {
  document.getElementById("SideMenu").style.width = "250px";
}

function closeNav() {
  document.getElementById("SideMenu").style.width = "0";
}

// Function to validate the registration form
document.getElementById("formRegister").addEventListener("submit", function(event) {
    event.preventDefault(); // Prevent the default form submission

    // Collect form data
    const firstName = document.querySelector("[name='fname']").value.trim();
    const lastName = document.querySelector("[name='lname']").value.trim();
    const email = document.querySelector("[name='email']").value.trim();
    const phoneNo = document.querySelector("[name='phoneNo']").value.trim();
    const password1 = document.querySelector("[name='password1']").value.trim();
    const password2 = document.querySelector("[name='password2']").value.trim();

    // Placeholder for error messages
    const errorPlaceholder = document.getElementById("errorMessagePlaceholder");
    errorPlaceholder.innerHTML = ""; // Clear previous errors

    // Validate inputs
    let errors = [];

    if (!firstName) errors.push("First name is required.");
    if (!lastName) errors.push("Last name is required.");
    if (!email || !validateEmail(email)) errors.push("A valid email address is required.");
    if (!phoneNo) errors.push("Phone number is required.");
    if (!password1 || password1.length < 8) errors.push("Password must be at least 8 characters.");
    if (password1 !== password2) errors.push("Passwords do not match.");

    // If errors exist, show them and stop submission
    if (errors.length > 0) {
        errorPlaceholder.innerHTML = errors.join("<br>");
        return;
    }

    // Prepare data to send to the server
    const formData = {
        fname: firstName,
        lname: lastName,
        email: email,
        phonenum: phoneNo,
        password1: password1,
        password2: password2,
    };

    // Send data to the server
    fetch("/api/register/", { // Update the URL to your API endpoint
        method: "POST",
        headers: {
            "Content-Type": "application/json",
        },
        body: JSON.stringify(formData),
    })
    .then(response => {
        if (!response.ok) {
            return response.json().then(data => {
                throw new Error(data.message || "Failed to create account.");
            });
        }
        return response.json();
    })
    .then(data => {
        alert("Account created successfully! Redirecting to sign-in page...");
        window.location.href = "SignIn.html"; // Redirect to the sign-in page
    })
    .catch(error => {
        errorPlaceholder.innerHTML = error.message;
    });
});

// Utility function to validate email
function validateEmail(email) {
    const regex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
    return regex.test(email);
}
</script>
 
 <div class="pagecontent">
 
	<form id="formRegister" class="formRegister" >
	
		<h1>Create an Account </h1>
		<label for="fname" class="fieldLabel">First Name:</label><br>
		{{ form.fname }}<br>
		<label for="lname" class="fieldLabel">Last Name:</label><br>
		{{ form.lname }}<br>
		<label for="femail" class="fieldLabel">Email:</label><br>
		{{ form.email }}<br>
		<label for="fphonenum" class="fieldLabel">Phone Number:</label><br>
		{{ form.phoneNo }}<br>
		<label for="fpass" class="fieldLabel">Password:</label><br>
		{{ form.password1 }}<br>
		<p><i>*Passwords must be at least 8 characters.</i></p>
		<label for="frepass" class="fieldLabel">Re-enter password:</label><br>
		{{ form.password2 }}<br>

		<input style="margin-left: 100px" id="BtnSubmit" name="BtnSubmit" type="submit" class="BtnSubmit" value="Create Account">
		<p id="errorMessagePlaceholder" class="errorMsg">{{ form.errors }}</p>
		
	</form>
</div>

	
 </div>


<!--********* Footer *********-->
<footer class="footer">
	<div>
		<h1><b>Social media<br></b></h1>
		<p>
		<a href="https://discord.com/">Discord</a><br>
		<a href="https://www.instagram.com/">Instagram</a><br>
		<a href="https://www.facebook.com/homeofmovies29/">Facebook</a><br>
		<a href="https://www.reddit.com/?rdt=34230">Redit</a><br>
		</p>
	</div>
	<div>
		<h1><b>Authors<br></b></h1>
		<p> 
			Stanislaw Krzysztof Graczykowski<br>
			Paul-Constantin Axinte<br>
			Krzysztof Sekulski<br>
			Eugénia Ficková<br>
			Alexandre Jorge Duarte Marques Pinto<br>
			Ruta Miglava
		</p>
	</div>
	<div>
		<h1><b>Contact Us<br></b></h1>
		<p> 
			email@email.com<br>
			SDU<br>
			Sonderborg<br>
			Denmark
		</p>
	</div>
  
</footer>
 
 <!--****************************************************-->
 
 

 

<br></br></br></br></br></br></br></br></br></br></br></br></br></br></br></br></br></br></br>

<br></br></br></br></br></br></br></br></br></br></br></br></br></br></br></br></br></br></br>

<br></br></br></br></br></br></br></br></br></br></br></br></br></br></br></br></br></br></br>

<br></br></br></br></br></br></br></br></br></br></br></br></br></br></br></br></br></br></br>

<script src="{% static 'js/Register.js' %}"></script>
</body>
</html>
